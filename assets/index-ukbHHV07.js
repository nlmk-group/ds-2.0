import{r as n,j as a,e as v4,m as x4}from"./iframe-zk5xXBtA.js";import{c as V4}from"./colorsMapping-C6bFIk14.js";import{I as w4}from"./index-BbV7Z3ze.js";import{I as D4}from"./index-1zUxKm4P.js";import{c as s4}from"./clsx-B-dksMZM.js";import{l as q4}from"./lodash-CJNAKYux.js";import{u as S4}from"./useFloatingReferenceSync-C6rFkWeV.js";import{B as R}from"./index-cDYWclvM.js";import{T as f4}from"./index-9BCGLlQQ.js";import{S as T4}from"./index-nkEoHT74.js";import{C as R4}from"./index-CsA5WfEK.js";import{M as j4}from"./index-Bl9Rvqm8.js";import{u as N4,a as L4,o as M4,f as k4,s as P4,l as H4}from"./floating-ui.react-0uHpbrLG.js";import{L as O4}from"./index-VfIgyswx.js";import{T as z4}from"./index-DjSUGs5w.js";const $4="Autocomplete-module__autocomplete___5vtE-",U4={autocomplete:$4},B4=n.createContext({isOpen:!1,disabled:!1,withPortal:!1,wrapperRef:{current:null},targetRef:{current:null},inputRef:{current:null},isLoading:!1,showCreateItem:!1,onCreateItem:()=>{},currentItems:[],inputValue:"",highlightedIndex:-1,selectedItems:[],createItemText:u=>`Добавить: ${u}`,onSelectMenuItem:()=>{},noResultsText:"",showTooltip:!1,renderLabel:void 0,portalContainerId:"root",totalText:"Всего:",showTotalCount:!0,showEmptyDropdown:!0,handleClickAway:()=>{}}),K4=({wrapperRef:u,targetRef:l,callback:s,canLoadMore:o,isPortalMounted:c})=>{let i=null;n.useEffect(()=>{const m=u.current,d=l.current;if(m&&d){const A={root:m,rootMargin:"10px",threshold:.5};i=new IntersectionObserver(([v])=>{if(v){const{isIntersecting:g}=v;g&&o&&s()}},A),i.observe(d)}return()=>{d&&i&&i.unobserve(d)}},[u,l,s,o,c])},W4=(u,l)=>{const s=n.useRef(l);return n.useEffect(()=>{s.current=l},[l]),n.useCallback(q4.debounce((...o)=>{s.current?.(...o)},u),[u])},Q4="AutocompleteItem-module__item___ujtSA",J4="AutocompleteItem-module__disabled___dh-8E",X4="AutocompleteItem-module__highlighted___ljVRT",z={item:Q4,"item-position":"AutocompleteItem-module__item-position___e5ejo",disabled:J4,highlighted:X4},$=({children:u,onClick:l,value:s,className:o,disabled:c=!1,hint:i="",highlighted:m=!1})=>{const d=A=>{A.stopPropagation(),!c&&l&&l(s)};return a.jsx(O4,{className:s4(z.item,o,{[z.disabled]:c},{[z.highlighted]:m}),onClick:d,role:"option","aria-disabled":c||void 0,children:a.jsx(R,{children:a.jsx(z4,{title:i,delayShow:500,children:a.jsx("div",{className:z["item-position"],children:u})})})})};try{$.displayName="AutocompleteItem",$.__docgenInfo={description:"Компонент AutocompleteItem представляет собой элемент списка меню, который может содержать иконку и текст.",displayName:"AutocompleteItem",props:{children:{defaultValue:null,description:"Содержимое элемента меню",name:"children",required:!0,type:{name:"ReactNode"}},onClick:{defaultValue:null,description:"Обработчик клика, вызываемый при выборе элемента",name:"onClick",required:!1,type:{name:"((value: string) => void)"}},value:{defaultValue:null,description:"Значение, связанное с элементом меню",name:"value",required:!0,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"Отключает возможность выбора элемента меню",name:"disabled",required:!1,type:{name:"boolean"}},hint:{defaultValue:{value:""},description:"Текст тултипа для элемента",name:"hint",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"Дополнительный CSS-класс",name:"className",required:!1,type:{name:"string"}},highlighted:{defaultValue:{value:"false"},description:"Внутренний проп для подсветки текущего элемента при фокусе или наведении с клавиатуры",name:"highlighted",required:!1,type:{name:"boolean"}}}}}catch{}const Y4="AutocompleteDropdown-module__card___gvOvS",Z4="AutocompleteDropdown-module__total___7VerO",q={card:Y4,"menu-item":"AutocompleteDropdown-module__menu-item___Av4zz","not-found-item":"AutocompleteDropdown-module__not-found-item___Q30-F",total:Z4},U=(u,l)=>{if(!l||!u)return u;const s=new RegExp(`(${l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return u.split(s).map((c,i)=>c.toLowerCase()===l.toLowerCase()?a.jsx("b",{children:c},i):c)},j=(u,l)=>{if(!l)return u;if(Array.isArray(u))return u.map((s,o)=>a.jsx(v4.Fragment,{children:j(s,l)},o));if(typeof u=="string")return U(u,l);if(n.isValidElement(u)){const s=n.Children.map(u.props.children,o=>j(o,l));return n.cloneElement(u,{children:s})}return u};try{U.displayName="boldString",U.__docgenInfo={description:"Выделяет жирным шрифтом части строки, соответствующие поисковому запросу",displayName:"boldString",props:{}}}catch{}try{j.displayName="boldReactElement",j.__docgenInfo={description:`Рекурсивно обрабатывает React элементы и их дочерние элементы,
выделяя жирным шрифтом части текста, соответствующие поисковому запросу`,displayName:"boldReactElement",props:{}}}catch{}const r4=({className:u,style:l})=>{const{portalContainerId:s,isOpen:o,withPortal:c,inputRef:i,wrapperRef:m,isLoading:d,showCreateItem:A,onCreateItem:v,currentItems:g,inputValue:F,highlightedIndex:p,selectedItems:K=[],createItemText:N,onSelectMenuItem:W,noResultsText:L,targetRef:f,showTooltip:Q,renderLabel:S,totalText:M,showTotalCount:k,showEmptyDropdown:J,handleClickAway:X}=n.useContext(B4),[Y,Z]=n.useState(null),[G,P]=n.useState(!1),u4=document.getElementById(s),{refs:e4,floatingStyles:t4,placement:_}=N4({placement:"bottom-start",middleware:[M4(4),k4({fallbackPlacements:["top-start"]}),P4({limiter:H4(),padding:8})],whileElementsMounted:L4});if(S4(i,Y,e4,P),n.useEffect(()=>{if(p<0)return;const t=m.current?.querySelectorAll(`.${q["menu-item"]}`);t&&t[p]&&t[p].scrollIntoView({block:"nearest"})},[p]),!o)return null;const I=i?.current?.getBoundingClientRect(),E=()=>({width:I?.width,...t4,visibility:G?"visible":"hidden"}),C=(g??[]).length>0,h=a.jsx(R4,{onClickAway:X,excludeRef:i,children:a.jsxs("div",{ref:t=>{t&&(m&&typeof m=="object"&&(m.current=t),Z(t))},className:s4(q.card,u),style:{...E(),...l},"data-popper-placement":_,"data-ui-autocomplete-dropdown":!0,children:[!d&&a.jsxs(R,{flexDirection:"column",gap:0,"data-ui-autocomplete-content":!0,children:[A&&F&&a.jsx($,{className:q["menu-item"],onClick:()=>v?.(F),value:F,highlighted:p===0,"data-ui-autocomplete-create-item":!0,children:N?.(F)??`Добавить: ${F}`},"__create_item__"),C?a.jsxs(a.Fragment,{children:[k&&a.jsxs(f4,{className:q.total,variant:"Caption-Medium",color:"var(--steel-90)","data-ui-autocomplete-total":!0,children:[M," ",g?.length]}),g?.map((t,D)=>{if(!t.label)return null;const H=F.trim(),y=S?j(S(t),H):U(t.label||"",H),B=t.disabled||!!K?.some(x=>x.value===t.value);return a.jsx($,{disabled:B,className:q["menu-item"],onClick:()=>W?.(t),value:t.name||"",highlighted:D===p,hint:Q?t.label:"","data-ui-autocomplete-item":!0,children:y},t.id)})]}):J&&a.jsx(R,{flexDirection:"column","data-ui-autocomplete-empty":!0,children:a.jsxs(R,{gap:8,flexDirection:"row",className:q["not-found-item"],alignItems:"center","data-ui-autocomplete-no-results":!0,children:[a.jsx(D4,{color:"error",name:"IconCancelOutlined16",containerSize:16}),a.jsx(f4,{variant:"Body1-Medium",color:"var(--steel-90)",children:L??"Ничего не найдено"})]})})]}),d&&a.jsx(j4,{label:a.jsx(R,{"data-testid":"AUTOCOMPLETE_LOADING",justifyContent:"center","data-ui-autocomplete-loading":!0,children:a.jsx(T4,{})}),value:"",disabled:!0}),a.jsx("div",{ref:t=>{t&&f&&typeof f=="object"&&(f.current=t)}})]})});return c?x4.createPortal(h,u4):h};try{r4.displayName="AutocompleteDropdown",r4.__docgenInfo={description:"",displayName:"AutocompleteDropdown",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}}}catch{}const E4=({selected:u,items:l=[],isLoading:s=!1,nameGetter:o,renderLabel:c,disabled:i=!1,onChange:m,onFullItemSelect:d,noSelectionItem:A,onDebouncedInputChange:v,size:g,showTooltip:F=!1,readOnly:p=!1,helperText:K="",error:N=!1,isFullWidth:W=!1,withPortal:L=!1,onLoadOptions:f,portalContainerId:Q="root",canLoadMore:S=!1,onLoadMore:M,onCreateItem:k,noResultsText:J="Ничего не найдено",createItemText:X=_=>`Добавить: ${_}`,totalText:Y="Всего:",showTotalCount:Z=!0,debounceDelay:G=500,showEmptyDropdown:P=!0,className:u4,style:e4,...t4})=>{const[_,I]=n.useState([]),[E,C]=n.useState(""),[h,t]=n.useState(l??[]),[D,H]=n.useState(l),[y,B]=n.useState(!1),[x,O]=n.useState(-1),[b,V]=n.useState(!1),i4=n.useRef(null),d4=n.useRef(null),a4=n.useRef(null),l4=W4(G,e=>{v?.(e),f&&f(e)});n.useEffect(()=>{u?(I([u]),b||C(o(u))):b||(I([]),C(""))},[u,o,b]),n.useEffect(()=>{if(l&&!s){const e=l.filter(r=>r.id!==void 0&&Number(r.id)>=0||Number.isNaN(Number(r.id)));H(e),t(b?c4(e,E,o):e),O(-1)}},[l,s,E,o,b]);const C4=n.useCallback(e=>{if(!D)return o(e);const r=D.find(w=>w.id===e.value);return o(e,r)},[D,o]),c4=(e,r,w)=>{const o4=r.trim().toLowerCase();return e.filter(T=>(T.label||w(T)||"").trim().toLowerCase().includes(o4)).map(T=>({...T,label:w(T).trim()}))},h4=({target:{value:e}})=>{p||(C(e),V(!0),B(!0),e.trim()?(t(c4(D??[],e,o)),l4(e)):(I([]),m(A??void 0),d?.(void 0),f&&(l4.cancel(),f("")),t([])))},m4=e=>{const r=C4(e);if(d){const w=D?.find(o4=>o4.id===e.value);d(w??e)}I([e]),C(r),V(!1),m(e),a4.current?.focus(),B(!1)},n4=()=>{C(""),I([]),V(!1),m(A??void 0),d?.(void 0),f&&(l4.cancel(),f("")),B(!1),t([])},A4=()=>{B(!1),b&&(u?(C(o(u)),V(!1),t(D??[])):E.trim()?V(!1):n4())},F4=()=>{!p&&!i&&(B(!0),b||t(D??[]))},y4=e=>{if(!(p||i))switch(e.key){case"ArrowDown":e.preventDefault(),y?O(r=>r<h.length-1?r+1:r):(B(!0),O(0));break;case"ArrowUp":e.preventDefault(),y&&O(r=>r>0?r-1:r);break;case"Enter":e.preventDefault(),y&&x>=0&&h[x]&&m4(h[x]);break;case"Escape":if(e.preventDefault(),y){B(!1);const r=_[0];r&&(C(o(r)),V(!1),t(D??[]))}break;case"Backspace":!E&&_.length>0&&n4();break}};K4({wrapperRef:i4,targetRef:d4,callback:()=>{M&&S&&M()},canLoadMore:S,isPortalMounted:L});const g4=h?.some(e=>e.label?.trim().toLowerCase()===E.trim().toLowerCase()),p4=k&&E.trim()!==""&&!g4,_4=(h??[]).length>0,I4=y&&!i&&!p&&(P||_4||p4||s),b4=a.jsx(r4,{});return a.jsx(B4.Provider,{value:{isOpen:y,disabled:i,portalContainerId:Q,withPortal:L,inputRef:a4,wrapperRef:i4,targetRef:d4,isLoading:s,showCreateItem:p4,onCreateItem:k,currentItems:h,inputValue:E,highlightedIndex:x,selectedItems:_,createItemText:X,onSelectMenuItem:m4,noResultsText:J,showTooltip:F,renderLabel:c,totalText:Y,showTotalCount:Z,showEmptyDropdown:P,handleClickAway:A4},children:a.jsxs("div",{className:s4(U4.autocomplete,u4),style:{width:W?"100%":"auto",...e4},"data-ui-autocomplete":!0,children:[a.jsx(w4,{...t4,inputRef:a4,value:E,onKeyDown:y4,icon:a.jsx(D4,{name:"IconSearchOutlined24",color:i&&"disabled"||N&&"error"||"primary","data-ui-autocomplete-search":!0}),reset:!0,onReset:n4,size:g,disabled:i,color:N?V4.error:void 0,helperText:K,onFocus:()=>{!i&&!p&&B(!0)},onClick:F4,onChange:h4,"data-ui-autocomplete-input":!0,"data-testid":"AUTOCOMPLETE_INPUT"}),I4&&b4]})})};try{E4.displayName="Autocomplete",E4.__docgenInfo={description:"Компонент Autocomplete предоставляет пользователю возможность ввода текста с поддержкой автозаполнения на основе предложенных элементов.",displayName:"Autocomplete",props:{selected:{defaultValue:null,description:"Изначально выбранный элемент",name:"selected",required:!1,type:{name:"IAutocompleteValue"}},items:{defaultValue:{value:"[]"},description:"Массив элементов для автозаполнения",name:"items",required:!1,type:{name:"IAutocompleteValue[] | null"}},isLoading:{defaultValue:{value:"false"},description:"Состояние загрузки данных",name:"isLoading",required:!1,type:{name:"boolean"}},nameGetter:{defaultValue:null,description:"Функция для получения строки, которая будет отображаться пользователю",name:"nameGetter",required:!0,type:{name:"(item: IAutocompleteValue, fullDataItem?: any) => string"}},renderLabel:{defaultValue:null,description:"Кастомный рендер label для опций",name:"renderLabel",required:!1,type:{name:"((item: IAutocompleteValue) => ReactNode)"}},onChange:{defaultValue:null,description:"Колбэк при выборе/очистке элемента",name:"onChange",required:!0,type:{name:"(item?: IAutocompleteValue | undefined) => void"}},onFullItemSelect:{defaultValue:null,description:"Колбэк для получения полного объекта выбранного элемента",name:"onFullItemSelect",required:!1,type:{name:"((item?: any) => void)"}},onDebouncedInputChange:{defaultValue:null,description:"Колбэк, вызываемый после завершения ввода (с задержкой debounce)",name:"onDebouncedInputChange",required:!1,type:{name:"((value: string) => void)"}},disabled:{defaultValue:{value:"false"},description:"Отключить ввод и выбор",name:"disabled",required:!1,type:{name:"boolean"}},helperText:{defaultValue:{value:""},description:"Сообщение об ошибке",name:"helperText",required:!1,type:{name:"string"}},error:{defaultValue:{value:"false"},description:"Флаг состояния ошибки",name:"error",required:!1,type:{name:"boolean"}},noSelectionItem:{defaultValue:null,description:'Значение, которое будет считаться "пустым"',name:"noSelectionItem",required:!1,type:{name:"IAutocompleteValue"}},showTooltip:{defaultValue:{value:"false"},description:"Показывать ли tooltip при наведении на опции",name:"showTooltip",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Только для чтения",name:"readOnly",required:!1,type:{name:"boolean"}},isFullWidth:{defaultValue:{value:"false"},description:"Занимать полную ширину",name:"isFullWidth",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:null,description:"Placeholder для поля ввода",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Подпись для поля ввода",name:"label",required:!1,type:{name:"string"}},withPortal:{defaultValue:{value:"false"},description:"Рендерить выпадающее меню через портал",name:"withPortal",required:!1,type:{name:"boolean"}},portalContainerId:{defaultValue:{value:"root"},description:"ID контейнера для портала",name:"portalContainerId",required:!1,type:{name:"string"}},size:{defaultValue:null,description:"Размер компонента",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"s"'},{value:'"m"'}]}},onLoadOptions:{defaultValue:null,description:"Колбэк для запроса новых данных при вводе",name:"onLoadOptions",required:!1,type:{name:"((query: string) => void)"}},canLoadMore:{defaultValue:{value:"false"},description:"Можно ли загрузить больше данных",name:"canLoadMore",required:!1,type:{name:"boolean"}},onLoadMore:{defaultValue:null,description:"Колбэк для догрузки данных при скролле",name:"onLoadMore",required:!1,type:{name:"(() => void)"}},onCreateItem:{defaultValue:null,description:"Колбэк для создания нового элемента",name:"onCreateItem",required:!1,type:{name:"((value: string) => void)"}},noResultsText:{defaultValue:{value:"Ничего не найдено"},description:"Текст при отсутствии результатов",name:"noResultsText",required:!1,type:{name:"string"}},createItemText:{defaultValue:{value:"(value: string) => `Добавить: ${value}`"},description:"Функция для генерации текста кнопки создания элемента",name:"createItemText",required:!1,type:{name:"((value: string) => string)"}},totalText:{defaultValue:{value:"Всего:"},description:"Текст для отображения общего количества элементов",name:"totalText",required:!1,type:{name:"string"}},debounceDelay:{defaultValue:{value:"500"},description:"Задержка в миллисекундах для debounce при вводе",name:"debounceDelay",required:!1,type:{name:"number"}},showTotalCount:{defaultValue:{value:"true"},description:"Показывать ли общее количество элементов",name:"showTotalCount",required:!1,type:{name:"boolean"}},showEmptyDropdown:{defaultValue:{value:"true"},description:"Показывать ли дропдаун при отсутствии результатов",name:"showEmptyDropdown",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"Дополнительный CSS класс",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"Inline стили для кастомизации компонента",name:"style",required:!1,type:{name:"CSSProperties"}},name:{defaultValue:null,description:"Имя инпута",name:"name",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"Значение инпута",name:"value",required:!1,type:{name:"string | (string & readonly string[])"}},id:{defaultValue:null,description:"Уникальный идентификатор инпута",name:"id",required:!1,type:{name:"string"}},onBlur:{defaultValue:null,description:"Обработчик потери фокуса",name:"onBlur",required:!1,type:{name:"(ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement> & FocusEventHandler<HTMLInputElement> & FocusEventHandler<...>)"}},onReset:{defaultValue:null,description:"Обработчик сброса значения",name:"onReset",required:!1,type:{name:"((() => void) & FormEventHandler<HTMLInputElement> & FormEventHandler<HTMLTextAreaElement>)"}},reset:{defaultValue:null,description:"Флаг наличия кнопки сброса",name:"reset",required:!1,type:{name:"boolean"}},multiline:{defaultValue:null,description:"Флаг многострочного режима",name:"multiline",required:!1,type:{name:"boolean"}},pseudo:{defaultValue:null,description:"Флаг псевдо-инпута",name:"pseudo",required:!1,type:{name:"boolean"}},icon:{defaultValue:null,description:"Иконка инпута",name:"icon",required:!1,type:{name:"ReactNode"}},resize:{defaultValue:null,description:"Флаг возможности изменения размера (для textarea)",name:"resize",required:!1,type:{name:"boolean"}},colored:{defaultValue:null,description:"Флаг цветного фона",name:"colored",required:!1,type:{name:"boolean"}},pseudoInputStyle:{defaultValue:null,description:"Инлайн стили для PseudoInput режима",name:"pseudoInputStyle",required:!1,type:{name:"CSSProperties"}},inputRef:{defaultValue:null,description:"Реф для доступа к DOM-элементу инпута",name:"inputRef",required:!1,type:{name:"Ref<HTMLInputElement | HTMLTextAreaElement>"}}}}}catch{}export{E4 as A};
