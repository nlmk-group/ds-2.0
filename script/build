#!/bin/bash

echo "ğŸš€ Building NLMK DS 2.0 library..."

yarn convert:dark-theme-tokens

rm -rf lib cache

# Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ñ Vite (Ğ²ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ JS, CSS Ğ¸ Ñ‚Ğ¸Ğ¿Ñ‹)
BUILD_MODE=lib yarn vite build

# ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²
echo "ğŸ“¦ Copying static assets..."
mkdir -p lib/css lib/fonts

# ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ CSS Ğ¸ ÑˆÑ€Ğ¸Ñ„Ñ‚Ñ‹
cp -r public/css/* lib/css/ 2>/dev/null || true
cp -r public/fonts/* lib/fonts/ 2>/dev/null || true

# Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ CSS Ñ„Ğ°Ğ¹Ğ»
cat > lib/css/main.css << 'EOF'
/* NLMK DS 2.0 Styles */
@import './style.css';
@import './temp-variables.css';
@import './dark-theme-storybook.css';
EOF

# ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° entry points
node script/entryPoints.js

echo "âœ… Build completed successfully!"